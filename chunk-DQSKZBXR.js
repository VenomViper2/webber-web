import{h as R,i as D,j as P,o as B}from"./chunk-BOLOGF76.js";import{Da as C,Fa as f,G as w,Ha as p,I as x,Ja as d,Ka as g,L as T,La as n,Ma as a,O,Qa as b,T as k,Ua as o,Va as s,W as I,Wa as l,Xa as G,Ya as h,Za as v,_a as u,i as M,n as E,q as m,r as F,va as r,wa as A,x as $}from"./chunk-EJJWSFQS.js";var _=class i{constructor(t){this.http=t;this.mechanicsData$=this.initializeMechanicsData()}MECHANICS_URL="data/combat-mechanics.json";RETRY_ATTEMPTS=3;mechanicsData$;initializeMechanicsData(){return this.http.get(this.MECHANICS_URL).pipe(w(this.RETRY_ATTEMPTS),$(this.handleError),x(1))}handleError(t){let e=t.error instanceof ErrorEvent?`Client-side error: ${t.error.message}`:`Server error: ${t.status} ${t.message}`;return console.error("GameMechanicsService error:",e),E(()=>new Error(e))}getCombatActions(){return this.mechanicsData$.pipe(m(t=>[...t.combatActions.baseActions,...t.combatActions.reactions]))}getBasicFeats(){return this.mechanicsData$.pipe(m(t=>t.basicFeats))}getCharacteristics(){return this.mechanicsData$.pipe(m(t=>t.characteristics))}getRankSystem(){return this.mechanicsData$.pipe(m(t=>t.rankSystem))}getExperienceCosts(){return this.mechanicsData$.pipe(m(t=>t.experienceCosts))}getAllMechanics(){return this.mechanicsData$}static \u0275fac=function(e){return new(e||i)(k(B))};static \u0275prov=O({token:i,factory:i.\u0275fac,providedIn:"root"})};var y=(i,t)=>t.name,N=(i,t)=>t.rank,U=(i,t)=>t.type,z=i=>["border-l-4",i],j=i=>[i];function Y(i,t){if(i&1&&(n(0,"div",12),o(1),a()),i&2){let e=b().$implicit;r(),l("Cost: ",e.cost,"")}}function q(i,t){if(i&1&&(n(0,"div",12),o(1),a()),i&2){let e=b().$implicit;r(),l("Refresh: ",e.refresh,"")}}function J(i,t){if(i&1&&(n(0,"div",4)(1,"h3",9),o(2),a(),n(3,"div",10),o(4),a(),n(5,"p",11),o(6),a(),C(7,Y,2,1,"div",12)(8,q,2,1,"div",12),a()),i&2){let e=t.$implicit;f("ngClass",h(7,z,e.type.toLowerCase()==="standard"?"border-blue-500":e.type.toLowerCase()==="reaction"?"border-green-500":e.type.toLowerCase()==="combat"?"border-red-500":"border-purple-500")),r(2),s(e.name),r(),f("ngClass",h(9,j,e.type.toLowerCase()==="standard"?"bg-blue-100 text-blue-800":e.type.toLowerCase()==="reaction"?"bg-green-100 text-green-800":e.type.toLowerCase()==="combat"?"bg-red-100 text-red-800":"bg-purple-100 text-purple-800")),r(),l(" ",e.type," "),r(2),s(e.description),r(),p(e.cost?7:-1),r(),p(e.refresh?8:-1)}}function K(i,t){if(i&1&&(n(0,"div",4)(1,"h3",9),o(2),a(),n(3,"div",10),o(4),a(),n(5,"p",11),o(6),a()()),i&2){let e=t.$implicit;f("ngClass",h(5,z,e.type.toLowerCase()==="passive"?"border-blue-500":"border-green-500")),r(2),s(e.name),r(),f("ngClass",h(7,j,e.type.toLowerCase()==="passive"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800")),r(),l(" ",e.type," "),r(2),s(e.effect)}}function Q(i,t){if(i&1&&(n(0,"div",6)(1,"h3",9),o(2),a(),n(3,"div",13),o(4),a()()),i&2){let e=t.$implicit;r(2),l("Level: ",e.rank,""),r(2),l("Total Sum: ",e.value,"")}}function W(i,t){if(i&1&&(n(0,"div",7)(1,"h3",9),o(2),v(3,"titlecase"),a(),n(4,"code",14),o(5),a()()),i&2){let e=t.$implicit;r(2),s(u(3,2,e.name)),r(3),s(e.formula)}}function X(i,t){if(i&1&&(n(0,"p",15),o(1,"Formula: "),n(2,"code",16),o(3),a()()),i&2){let e=b().$implicit;r(3),s(e.formula)}}function Z(i,t){if(i&1&&(n(0,"p",15),o(1,"Fixed Cost: "),n(2,"span",17),o(3),a()()),i&2){let e=b().$implicit;r(3),s(e.cost)}}function ee(i,t){if(i&1&&(n(0,"div",7)(1,"h3",9),o(2),v(3,"titlecase"),a(),C(4,X,4,1,"p",15)(5,Z,4,1,"p",15),a()),i&2){let e=t.$implicit;r(2),s(u(3,3,e.type)),r(2),p(e.formula?4:-1),r(),p(e.cost!==void 0?5:-1)}}function te(i,t){if(i&1&&(n(0,"section",1)(1,"h2",2),o(2,"Combat Actions"),a(),n(3,"div",3),d(4,J,9,11,"div",4,y),a()(),n(6,"section",1)(7,"h2",2),o(8,"Basic Feats"),a(),n(9,"div",3),d(10,K,7,9,"div",4,y),a()(),n(12,"section",1)(13,"h2",2),o(14,"Rank System"),a(),n(15,"p",5),o(16),a(),n(17,"div",3),d(18,Q,5,2,"div",6,N),a()(),n(20,"section",1)(21,"h2",2),o(22,"Derived Stats"),a(),n(23,"div",3),d(24,W,6,4,"div",7,y),a()(),n(26,"section",8)(27,"h2",2),o(28,"Experience Costs"),a(),n(29,"div",3),d(30,ee,6,5,"div",7,U),a()()),i&2){let e=t,c=b();r(4),g(e.combatActions),r(6),g(e.basicFeats),r(6),s(e.rankSystem.calculation),r(2),g(e.rankSystem.thresholds),r(6),g(c.getStatsEntries(e.characteristics.derivedStats)),r(6),g(c.getExperienceCostEntries(e.experienceCosts))}}var L=class i{constructor(t){this.gameMechanicsService=t;this.viewModel$=this.initializeViewModel()}destroy$=new M;viewModel$;initializeViewModel(){return F({mechanics:this.gameMechanicsService.getAllMechanics(),combatActions:this.gameMechanicsService.getCombatActions(),basicFeats:this.gameMechanicsService.getBasicFeats()}).pipe(m(({mechanics:t,combatActions:e,basicFeats:c})=>({combatActions:e,basicFeats:c,characteristics:t.characteristics,rankSystem:t.rankSystem,experienceCosts:t.experienceCosts,boonTriggers:t.boonTriggers})),x(1),T(this.destroy$))}getStatsEntries(t){return Object.entries(t).map(([e,c])=>({name:e,formula:c.formula,baseValue:c.baseValue}))}getExperienceCostEntries(t){return Object.entries(t).map(([e,c])=>({type:e,formula:c.formula,cost:c.cost}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||i)(A(_))};static \u0275cmp=I({type:i,selectors:[["app-game-mechanics"]],standalone:!0,features:[G],decls:3,vars:3,consts:[[1,"app-container","bg-gray-50","p-6"],[1,"mechanics-section","mb-8"],[1,"text-2xl","font-bold","text-gray-900","mb-4"],[1,"grid-layout"],[1,"card",3,"ngClass"],[1,"text-gray-600","mb-4"],[1,"card","bg-gradient-to-br","from-gray-50","to-gray-100"],[1,"card"],[1,"mechanics-section"],[1,"text-xl","font-semibold","mb-2"],[1,"type-badge",3,"ngClass"],[1,"text-gray-600","my-3"],[1,"info-tag"],[1,"text-gray-700"],[1,"block","bg-gray-100","p-2","rounded","text-sm"],[1,"text-gray-600"],[1,"bg-gray-100","px-2","py-1","rounded"],[1,"font-medium"]],template:function(e,c){if(e&1&&(n(0,"div",0),C(1,te,32,1),v(2,"async"),a()),e&2){let S;r(),p((S=u(2,1,c.viewModel$))?1:-1,S)}},dependencies:[D,R,P],styles:[".grid-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem;margin:1rem 0}.card[_ngcontent-%COMP%]{background-color:#fff;border-radius:.75rem;padding:1.5rem;border:1px solid #e2e8f0;box-shadow:0 2px 5px #0000001a;transition:transform .2s ease,box-shadow .2s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 6px 10px #00000026}.type-badge[_ngcontent-%COMP%]{display:inline-block;padding:.4rem 1rem;border-radius:1rem;font-size:.85rem;font-weight:600;border:1px solid rgba(0,0,0,.1);text-transform:uppercase}.info-tag[_ngcontent-%COMP%]{display:inline-block;background-color:#f3f4f6;padding:.4rem 1rem;border-radius:.5rem;font-size:.85rem;color:#374151;font-weight:500;margin-right:.5rem;margin-top:.5rem}h2[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#1f2937;border-bottom:2px solid #d1d5db;padding-bottom:.5rem}code[_ngcontent-%COMP%]{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;background-color:#f3f4f6;padding:.3rem .7rem;border-radius:.5rem;font-size:.9rem;font-weight:500;color:#1f2937}@media (max-width: 768px){.grid-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}h2[_ngcontent-%COMP%]{font-size:1.5rem}}"]})};export{L as GameMechanicsComponent};
