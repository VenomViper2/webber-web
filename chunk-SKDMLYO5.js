import{h as w,i as R,n as D}from"./chunk-6UMM6SVK.js";import{Da as g,Fa as _,G as y,Ha as l,I as C,Ja as d,Ka as f,L as O,La as r,Ma as n,O as $,Qa as p,T as F,Ua as o,Va as s,W as T,Wa as h,Xa as I,Za as G,_a as P,i as u,n as M,q as m,r as S,va as a,wa as A,x as E}from"./chunk-EJJWSFQS.js";var v=class i{constructor(e){this.http=e;this.mechanicsData$=this.initializeMechanicsData()}MECHANICS_URL="data/combat-mechanics.json";RETRY_ATTEMPTS=3;mechanicsData$;initializeMechanicsData(){return this.http.get(this.MECHANICS_URL).pipe(y(this.RETRY_ATTEMPTS),E(this.handleError),C(1))}handleError(e){let t=e.error instanceof ErrorEvent?`Client-side error: ${e.error.message}`:`Server error: ${e.status} ${e.message}`;return console.error("GameMechanicsService error:",t),M(()=>new Error(t))}getCombatActions(){return this.mechanicsData$.pipe(m(e=>[...e.combatActions.baseActions,...e.combatActions.reactions]))}getBasicFeats(){return this.mechanicsData$.pipe(m(e=>e.basicFeats))}getCharacteristics(){return this.mechanicsData$.pipe(m(e=>e.characteristics))}getRankSystem(){return this.mechanicsData$.pipe(m(e=>e.rankSystem))}getExperienceCosts(){return this.mechanicsData$.pipe(m(e=>e.experienceCosts))}getAllMechanics(){return this.mechanicsData$}static \u0275fac=function(t){return new(t||i)(F(D))};static \u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"})};var b=(i,e)=>e.name,V=(i,e)=>e.type;function H(i,e){if(i&1&&(r(0,"div",14),o(1),n()),i&2){let t=p().$implicit;a(),h("Cost: ",t.cost,"")}}function N(i,e){if(i&1&&(r(0,"div",15),o(1),n()),i&2){let t=p().$implicit;a(),h("Refresh: ",t.refresh,"")}}function z(i,e){if(i&1&&(r(0,"div",3)(1,"h3"),o(2),n(),r(3,"div",13),o(4),n(),r(5,"p"),o(6),n(),g(7,H,2,1,"div",14)(8,N,2,1,"div",15),n()),i&2){let t=e.$implicit;_("ngClass",t.type.toLowerCase()),a(2),s(t.name),a(2),s(t.type),a(2),s(t.description),a(),l(t.cost?7:-1),a(),l(t.refresh?8:-1)}}function L(i,e){if(i&1&&(r(0,"div",6)(1,"h3"),o(2),n(),r(3,"div",16),o(4),n(),r(5,"p"),o(6),n()()),i&2){let t=e.$implicit;_("ngClass",t.type.toLowerCase()),a(2),s(t.name),a(2),s(t.type),a(2),s(t.effect)}}function U(i,e){if(i&1&&(r(0,"div",9)(1,"h3"),o(2),n(),r(3,"p",17),o(4),n()()),i&2){let t=e.$implicit;a(2),s(t.name),a(2),s(t.formula)}}function Y(i,e){if(i&1&&(r(0,"p"),o(1),n()),i&2){let t=p().$implicit;a(),h("Formula: ",t.formula,"")}}function q(i,e){if(i&1&&(r(0,"p"),o(1),n()),i&2){let t=p().$implicit;a(),h("Fixed Cost: ",t.cost,"")}}function J(i,e){if(i&1&&(r(0,"div",12)(1,"h3"),o(2),n(),g(3,Y,2,1,"p")(4,q,2,1,"p"),n()),i&2){let t=e.$implicit;a(2),s(t.type),a(),l(t.formula?3:-1),a(),l(t.cost!==void 0?4:-1)}}function K(i,e){if(i&1&&(r(0,"section",1)(1,"h2"),o(2,"Combat Actions"),n(),r(3,"div",2),d(4,z,9,6,"div",3,b),n()(),r(6,"section",4)(7,"h2"),o(8,"Basic Feats"),n(),r(9,"div",5),d(10,L,7,4,"div",6,b),n()(),r(12,"section",7)(13,"h2"),o(14,"Derived Stats"),n(),r(15,"div",8),d(16,U,5,2,"div",9,b),n()(),r(18,"section",10)(19,"h2"),o(20,"Experience Costs"),n(),r(21,"div",11),d(22,J,5,3,"div",12,V),n()()),i&2){let t=e,c=p();a(4),f(t.combatActions),a(6),f(t.basicFeats),a(6),f(c.getStatsEntries(t.characteristics.derivedStats)),a(6),f(c.getExperienceCostEntries(t.experienceCosts))}}var k=class i{constructor(e){this.gameMechanicsService=e;this.viewModel$=this.initializeViewModel()}destroy$=new u;viewModel$;initializeViewModel(){return S({mechanics:this.gameMechanicsService.getAllMechanics(),combatActions:this.gameMechanicsService.getCombatActions(),basicFeats:this.gameMechanicsService.getBasicFeats()}).pipe(m(({mechanics:e,combatActions:t,basicFeats:c})=>({combatActions:t,basicFeats:c,characteristics:e.characteristics,rankSystem:e.rankSystem,experienceCosts:e.experienceCosts,boonTriggers:e.boonTriggers})),C(1),O(this.destroy$))}getStatsEntries(e){return Object.entries(e).map(([t,c])=>({name:t,formula:c.formula,baseValue:c.baseValue}))}getExperienceCostEntries(e){return Object.entries(e).map(([t,c])=>({type:t,formula:c.formula,cost:c.cost}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(t){return new(t||i)(A(v))};static \u0275cmp=T({type:i,selectors:[["app-game-mechanics"]],standalone:!0,features:[I],decls:3,vars:3,consts:[[1,"mechanics-container"],[1,"combat-section"],[1,"actions-grid"],[1,"action-card",3,"ngClass"],[1,"feats-section"],[1,"feats-grid"],[1,"feat-card",3,"ngClass"],[1,"characteristics-section"],[1,"stats-grid"],[1,"stat-card"],[1,"experience-section"],[1,"costs-grid"],[1,"cost-card"],[1,"action-type"],[1,"cost"],[1,"refresh"],[1,"feat-type"],[1,"formula"]],template:function(t,c){if(t&1&&(r(0,"div",0),g(1,K,24,0),G(2,"async"),n()),t&2){let x;a(),l((x=P(2,1,c.viewModel$))?1:-1,x)}},dependencies:[R,w],styles:[".mechanics-container[_ngcontent-%COMP%]{padding:1rem}.actions-grid[_ngcontent-%COMP%], .feats-grid[_ngcontent-%COMP%], .stats-grid[_ngcontent-%COMP%], .costs-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1rem;margin:1rem 0}.action-card[_ngcontent-%COMP%], .feat-card[_ngcontent-%COMP%], .stat-card[_ngcontent-%COMP%], .cost-card[_ngcontent-%COMP%]{padding:1rem;border-radius:.5rem;background-color:#fff;box-shadow:0 2px 4px #0000001a}.standard[_ngcontent-%COMP%]{border-left:4px solid #3b82f6}.reaction[_ngcontent-%COMP%]{border-left:4px solid #10b981}.combat[_ngcontent-%COMP%]{border-left:4px solid #ef4444}.utility[_ngcontent-%COMP%]{border-left:4px solid #8b5cf6}h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:1.5rem 0 1rem}h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:500;margin-bottom:.5rem}.formula[_ngcontent-%COMP%], .base-value[_ngcontent-%COMP%]{font-family:monospace;background-color:#f3f4f6;padding:.25rem .5rem;border-radius:.25rem;margin-top:.5rem}"]})};export{k as GameMechanicsComponent};
