import{h as w,i as R,n as D}from"./chunk-6UMM6SVK.js";import{Da as f,Fa as v,G as y,Ha as l,I as _,Ja as C,Ka as h,L as O,La as r,Ma as n,O as $,Qa as p,T as F,Ua as o,Va as s,W as T,Wa as d,Xa as A,Za as G,_a as P,i as u,n as M,q as m,r as S,va as a,wa as I,x as E}from"./chunk-EJJWSFQS.js";var g=class i{constructor(t){this.http=t;this.mechanicsData$=this.initializeMechanicsData()}MECHANICS_URL="data/combat-mechanics.json";RETRY_ATTEMPTS=3;mechanicsData$;initializeMechanicsData(){return this.http.get(this.MECHANICS_URL).pipe(y(this.RETRY_ATTEMPTS),E(this.handleError),_(1))}handleError(t){let e=t.error instanceof ErrorEvent?`Client-side error: ${t.error.message}`:`Server error: ${t.status} ${t.message}`;return console.error("GameMechanicsService error:",e),M(()=>new Error(e))}getCombatActions(){return this.mechanicsData$.pipe(m(t=>[...t.combatActions.baseActions,...t.combatActions.reactions]))}getBasicFeats(){return this.mechanicsData$.pipe(m(t=>t.basicFeats))}getCharacteristics(){return this.mechanicsData$.pipe(m(t=>t.characteristics))}getRankSystem(){return this.mechanicsData$.pipe(m(t=>t.rankSystem))}getExperienceCosts(){return this.mechanicsData$.pipe(m(t=>t.experienceCosts))}getAllMechanics(){return this.mechanicsData$}static \u0275fac=function(e){return new(e||i)(F(D))};static \u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"})};var x=(i,t)=>t.name,j=(i,t)=>t.type;function H(i,t){if(i&1&&(r(0,"div",14),o(1),n()),i&2){let e=p().$implicit;a(),d("Cost: ",e.cost,"")}}function N(i,t){if(i&1&&(r(0,"div",15),o(1),n()),i&2){let e=p().$implicit;a(),d("Refresh: ",e.refresh,"")}}function z(i,t){if(i&1&&(r(0,"div",3)(1,"h3"),o(2),n(),r(3,"div",13),o(4),n(),r(5,"p"),o(6),n(),f(7,H,2,1,"div",14)(8,N,2,1,"div",15),n()),i&2){let e=t.$implicit;v("ngClass",e.type.toLowerCase()),a(2),s(e.name),a(2),s(e.type),a(2),s(e.description),a(),l(e.cost?7:-1),a(),l(e.refresh?8:-1)}}function L(i,t){if(i&1&&(r(0,"div",6)(1,"h3"),o(2),n(),r(3,"div",16),o(4),n(),r(5,"p"),o(6),n()()),i&2){let e=t.$implicit;v("ngClass",e.type.toLowerCase()),a(2),s(e.name),a(2),s(e.type),a(2),s(e.effect)}}function U(i,t){if(i&1&&(r(0,"p",18),o(1),n()),i&2){let e=p().$implicit;a(),d("Base: ",e.baseValue,"")}}function Y(i,t){if(i&1&&(r(0,"div",9)(1,"h3"),o(2),n(),r(3,"p",17),o(4),n(),f(5,U,2,1,"p",18),n()),i&2){let e=t.$implicit;a(2),s(e.name),a(2),s(e.formula),a(),l(e.baseValue?5:-1)}}function q(i,t){if(i&1&&(r(0,"p"),o(1),n()),i&2){let e=p().$implicit;a(),d("Formula: ",e.formula,"")}}function J(i,t){if(i&1&&(r(0,"p"),o(1),n()),i&2){let e=p().$implicit;a(),d("Fixed Cost: ",e.cost,"")}}function K(i,t){if(i&1&&(r(0,"div",12)(1,"h3"),o(2),n(),f(3,q,2,1,"p")(4,J,2,1,"p"),n()),i&2){let e=t.$implicit;a(2),s(e.type),a(),l(e.formula?3:-1),a(),l(e.cost!==void 0?4:-1)}}function Q(i,t){if(i&1&&(r(0,"section",1)(1,"h2"),o(2,"Combat Actions"),n(),r(3,"div",2),C(4,z,9,6,"div",3,x),n()(),r(6,"section",4)(7,"h2"),o(8,"Basic Feats"),n(),r(9,"div",5),C(10,L,7,4,"div",6,x),n()(),r(12,"section",7)(13,"h2"),o(14,"Derived Stats"),n(),r(15,"div",8),C(16,Y,6,3,"div",9,x),n()(),r(18,"section",10)(19,"h2"),o(20,"Experience Costs"),n(),r(21,"div",11),C(22,K,5,3,"div",12,j),n()()),i&2){let e=t,c=p();a(4),h(e.combatActions),a(6),h(e.basicFeats),a(6),h(c.getStatsEntries(e.characteristics.derivedStats)),a(6),h(c.getExperienceCostEntries(e.experienceCosts))}}var k=class i{constructor(t){this.gameMechanicsService=t;this.viewModel$=this.initializeViewModel()}destroy$=new u;viewModel$;initializeViewModel(){return S({mechanics:this.gameMechanicsService.getAllMechanics(),combatActions:this.gameMechanicsService.getCombatActions(),basicFeats:this.gameMechanicsService.getBasicFeats()}).pipe(m(({mechanics:t,combatActions:e,basicFeats:c})=>({combatActions:e,basicFeats:c,characteristics:t.characteristics,rankSystem:t.rankSystem,experienceCosts:t.experienceCosts,boonTriggers:t.boonTriggers})),_(1),O(this.destroy$))}getStatsEntries(t){return Object.entries(t).map(([e,c])=>({name:e,formula:c.formula,baseValue:c.baseValue}))}getExperienceCostEntries(t){return Object.entries(t).map(([e,c])=>({type:e,formula:c.formula,cost:c.cost}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||i)(I(g))};static \u0275cmp=T({type:i,selectors:[["app-game-mechanics"]],standalone:!0,features:[A],decls:3,vars:3,consts:[[1,"mechanics-container"],[1,"combat-section"],[1,"actions-grid"],[1,"action-card",3,"ngClass"],[1,"feats-section"],[1,"feats-grid"],[1,"feat-card",3,"ngClass"],[1,"characteristics-section"],[1,"stats-grid"],[1,"stat-card"],[1,"experience-section"],[1,"costs-grid"],[1,"cost-card"],[1,"action-type"],[1,"cost"],[1,"refresh"],[1,"feat-type"],[1,"formula"],[1,"base-value"]],template:function(e,c){if(e&1&&(r(0,"div",0),f(1,Q,24,0),G(2,"async"),n()),e&2){let b;a(),l((b=P(2,1,c.viewModel$))?1:-1,b)}},dependencies:[R,w],styles:[".mechanics-container[_ngcontent-%COMP%]{padding:1rem}.actions-grid[_ngcontent-%COMP%], .feats-grid[_ngcontent-%COMP%], .stats-grid[_ngcontent-%COMP%], .costs-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:1rem;margin:1rem 0}.action-card[_ngcontent-%COMP%], .feat-card[_ngcontent-%COMP%], .stat-card[_ngcontent-%COMP%], .cost-card[_ngcontent-%COMP%]{padding:1rem;border-radius:.5rem;background-color:#fff;box-shadow:0 2px 4px #0000001a}.standard[_ngcontent-%COMP%]{border-left:4px solid #3b82f6}.reaction[_ngcontent-%COMP%]{border-left:4px solid #10b981}.combat[_ngcontent-%COMP%]{border-left:4px solid #ef4444}.utility[_ngcontent-%COMP%]{border-left:4px solid #8b5cf6}h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:1.5rem 0 1rem}h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:500;margin-bottom:.5rem}.formula[_ngcontent-%COMP%], .base-value[_ngcontent-%COMP%]{font-family:monospace;background-color:#f3f4f6;padding:.25rem .5rem;border-radius:.25rem;margin-top:.5rem}"]})};export{k as GameMechanicsComponent};
